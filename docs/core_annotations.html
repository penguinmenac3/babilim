---

title: babilim.core.annotations

keywords: fastai
sidebar: home_sidebar

summary: "A collection of helpful annotations."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: babilim-notebooks/core_annotations.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ClassDecorator" class="doc_header"><code>class</code> <code>ClassDecorator</code><a href="https://github.com/penguinmenac3/babilim/tree/master/babilim/core/annotations.py#L33" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ClassDecorator</code>() :: <code>ABC</code></p>
</blockquote>
<p>Helper class that provides a standard way to create an ABC using
inheritance.<h3 id="__call__" class="doc_header"><code>__call__</code></h3></p>
<blockquote><p><code>__call__</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<h3 id="__get__" class="doc_header"><code>__get__</code></h3><blockquote><p><code>__get__</code>(<strong><code>obj</code></strong>, <strong><code>objtype</code></strong>)</p>
</blockquote>
<p>A class decorator is a base class that is used for all annotations that should be usable with python classes. Regular annotations will not work with classes.</p>
<p>This is a helper class that can be used when writing annotations.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RunOnlyOnce" class="doc_header"><code>class</code> <code>RunOnlyOnce</code><a href="https://github.com/penguinmenac3/babilim/tree/master/babilim/core/annotations.py#L50" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RunOnlyOnce</code>(<strong><code>f</code></strong>) :: <a href="annotations.html#ClassDecorator"><code>ClassDecorator</code></a></p>
</blockquote>
<p>Helper class that provides a standard way to create an ABC using
inheritance.<h3 id="Constructor" class="doc_header">Constructor</h3></p>
<p>A decorator that ensures a function in an object gets only called exactly once.</p>
<ul>
<li><strong>f</strong>: The function that should be wrapped.</li>
</ul>
<h3 id="__call__" class="doc_header"><code>__call__</code></h3><blockquote><p><code>__call__</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The run only once annotation is fundamental for the build function pattern, whereas it allows to write a function which is only called once, no matter how often it gets called. This behaviour is very usefull for creating variables on the GPU only once in the build and not on every run of the neural network.
{% include important.html content="This is for use with the build function in a module. Ensuring it only gets called once and does not eat memory on the gpu." %}
Using this in an example function which prints the parameter only yields on printout, even though the function gets called multiple times.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@RunOnlyOnce</span>
<span class="k">def</span> <span class="nf">test_fun</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    
<span class="n">test_fun</span><span class="p">(</span><span class="s2">&quot;Foo&quot;</span><span class="p">)</span>
<span class="n">test_fun</span><span class="p">(</span><span class="s2">&quot;Foo&quot;</span><span class="p">)</span>
<span class="n">test_fun</span><span class="p">(</span><span class="s2">&quot;Foo&quot;</span><span class="p">)</span>
<span class="n">test_fun</span><span class="p">(</span><span class="s2">&quot;Foo&quot;</span><span class="p">)</span>
<span class="n">test_fun</span><span class="p">(</span><span class="s2">&quot;Foo&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Foo
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="extend_class" class="doc_header"><code>extend_class</code><a href="https://github.com/penguinmenac3/babilim/tree/master/babilim/core/annotations.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>extend_class</code>(<strong><code>clazz</code></strong>, <strong><code>function_name</code></strong>)</p>
</blockquote>
<p>Extend a class by the function decorated with this decorator.</p>
<p>:param clazz: The class that should be decorated.
:param function_name: The name that the function in the class should have. (Can be different than unbound name of the class.)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This annotation can be used for developing code in a jupyter notebook. It allows you to define a class in separate cells, like the following example. This gives you the exploratory capabilities of jupyter while developing a class that can be later exported (using nbdev) and used in production.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># first cell</span>
<span class="k">class</span> <span class="nc">TestClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_var</span> <span class="o">=</span> <span class="n">var</span>
        
<span class="c1"># later cell</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">TestClass</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
        
<span class="c1"># again later cell</span>
<span class="nd">@extend_class</span><span class="p">(</span><span class="n">TestClass</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">__foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.my_var=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_var</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;name=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

<span class="c1"># and again later cell</span>
<span class="n">test</span><span class="o">.</span><span class="n">foo</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>self.my_var=42
name=Hello
Hello
</pre>
</div>
</div>

</div>
</div>

</div>
</div>
 


---

title: babilim.model.module

keywords: fastai
sidebar: home_sidebar

summary: "The base class for every module."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: babilim-notebooks/model_module.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RunOnlyOnce object at 0x7f73a35dac10>" class="doc_header"><code>RunOnlyOnce object at 0x7f73a35dac10></code><a href="" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RunOnlyOnce object at 0x7f73a35dac10></code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Module" class="doc_header"><code>class</code> <code>Module</code><a href="https://github.com/penguinmenac3/babilim/tree/master/babilim/model/module.py#L49" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Module</code>(<strong><code>layer_type</code></strong>:<code>str</code>) :: <code>StatefullObject</code></p>
</blockquote>
<h3 id="Constructor" class="doc_header">Constructor</h3><p>A module is the base building block of all models and layers.</p>
<p>Users must overwrite <a href="__init__.html"><code>__init__</code></a>,<code>call</code> and <code>build</code>. For the latter do not forget the <code>@RunOnlyOnce</code>-Annotation. The rest comes pre implemented and should not be overwritten. When overwriting the <a href="__init__.html"><code>__init__</code></a> call the super init: <code>super().__init__(layer_type)</code>.</p>
<ul>
<li><strong>layer_type</strong>: The type of the layer provided.</li>
</ul>
<h3 id="__call__" class="doc_header"><code>__call__</code></h3><blockquote><p><code>__call__</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Makes a module callable. Automatically wraps tensorflow or pytorch tensors to ITensors from babilim.</p>
<p><code>module = MyModule()</code></p>
<p><code>module(*args, **kwargs)</code></p>
<p>Warning: This function should not be overwritten. Instead overwrite <code>call</code> with no underscores.</p>
<ul>
<li><strong>*args</strong>: All indexed parameters of your call function derivate.</li>
<li><strong>**kwargs</strong>: All named parameters of your call function derivate.</li>
</ul>
<h3 id="_register_params" class="doc_header"><code>_register_params</code></h3><blockquote><p><code>_register_params</code>()</p>
</blockquote>
<h3 id="build" class="doc_header"><code>build</code></h3><blockquote><p><code>build</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>This function will build your model and must be annotated with the RunOnlyOnce-Annotation.</p>
<p>Allocating weight tensors should be done here. You can make use of the knowledge of your inputs to compute shapes for your weight tensors. This will make coding dimensions a lot easier.</p>
<p><code> @RunOnlyOnce</code></p>
<p><code>def build(self, image: ITensor) -> None:</code></p>
<ul>
<li><strong>*args</strong>: You must specify the exact same parameters as for your call.</li>
<li><strong>**kwargs</strong>: You must specify the exact same parameters as for your call.</li>
</ul>
<h3 id="call" class="doc_header"><code>call</code></h3><blockquote><p><code>call</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Makes a module callable and contains the forward pass of your model. This should be pure computation and not allocate any weights. Allocating weights should be done in the <code>build</code> function.</p>
<p>This function gets called by <code>__call__</code> and must be overwritten by any derived class.</p>
<p><code>def call(self, image: ITensor) -> NetworkOutput:</code></p>
<ul>
<li><strong>*args</strong>: You can specify any parameters you want.</li>
<li><strong>**kwargs</strong>: You can specify any named parameters you want.</li>
</ul>
<h3 id="initialize" class="doc_header"><code>initialize</code></h3><blockquote><p><code>initialize</code>(<strong><code>dataset</code></strong>:<code>Dataset</code>)</p>
</blockquote>
<p>Initializes your module by running a sample of your dataset through it.</p>
<ul>
<li><strong>dataset</strong>: The dataset you want to use for initialization. (Must be of type babilim.data.Dataset)</li>
</ul>
<h3 id="modules" class="doc_header"><code>modules</code></h3><blockquote><p><code>modules</code>()</p>
</blockquote>
<p>Returns an iterator over all modules in the network.</p>
<h3 id="named_modules" class="doc_header"><code>named_modules</code></h3><blockquote><p><code>named_modules</code>(<strong><code>memo</code></strong>=<em><code>None</code></em>, <strong><code>prefix</code></strong>=<em><code>''</code></em>)</p>
</blockquote>
<p>A named list of all modules.</p>
<h3 id="predict" class="doc_header"><code>predict</code></h3><blockquote><p><code>predict</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Pass in single training examples as numpy arrays. And predict the value without gradients. Should be used for testing and evaluation.</p>
<p>If your network has eval modes you need to set them manually.</p>
<p>The array must not have batch dimension.</p>
<ul>
<li><strong>kwargs</strong>: The parameters to feed the network as a single example.</li>
<li><strong>return</strong>: The output for a single example.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
</div>
 

